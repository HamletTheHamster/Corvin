<!-- Coded By: Joel N. Johnson -->

<!-- 1 Header -->
<!DOCTYPE html>
<html lang = "en" class = "newUser">
<head class = "newUser">
  <title>Register | Corvin</title>
  <link href = 'one.css' type = 'text/css' rel = 'stylesheet' />

  <link rel = 'apple-touch-icon' sizes = '57x57'
    href = '../Art/Favicon/apple-icon-57x57.png' />
  <link rel = 'apple-touch-icon' sizes = '60x60'
    href = '../Art/Favicon/apple-icon-60x60.png' />
  <link rel = 'apple-touch-icon' sizes = '72x72'
    href = '../Art/Favicon/apple-icon-72x72.png' />
  <link rel = 'apple-touch-icon' sizes = '76x76'
    href = '../Art/Favicon/apple-icon-76x76.png' />
  <link rel = 'apple-touch-icon' sizes = '114x114'
    href = '../Art/Favicon/apple-icon-114x114.png' />
  <link rel = 'apple-touch-icon' sizes = '120x120'
    href = '../Art/Favicon/apple-icon-120x120.png' />
  <link rel = 'apple-touch-icon' sizes = '144x144'
    href = '../Art/Favicon/apple-icon-144x144.png' />
  <link rel = 'apple-touch-icon' sizes = '152x152'
    href = '../Art/Favicon/apple-icon-152x152.png' />
  <link rel = 'apple-touch-icon' sizes = '180x180'
    href = '../Art/Favicon/apple-icon-180x180.png' />
  <link rel = 'icon' type = 'image/png' sizes = '192x192'
    href = '../Art/Favicon/android-icon-192x192.png' />
  <link rel = 'icon' type = 'image/png' sizes = '32x32'
    href = '../Art/Favicon/favicon-32x32.png' />
  <link rel = 'icon' type = 'image/png' sizes = '96x96'
    href = '../Art/Favicon/favicon-96x96.png' />
  <link rel = 'icon' type = 'image/png' sizes = '16x16'
    href = '../Art/Favicon/favicon-16x16.png' />
  <link rel = 'manifest' href = '/manifest.json' />

  <meta name = 'msapplication-TileColor' content = '#ffffff' />
  <meta name = 'msapplication-TileImage' content = '/ms-icon-144x144.png' />
  <meta name = 'theme-color' content = '#ffffff' />

  <meta http-equiv = 'refresh' content = '855' />

  <meta name = 'google' content = 'notranslate' />

  <script type = "text/javascript" src = "jquery-3.4.1.min.js"></script>

  <script type = "text/javascript">
  var recaptchaID;
  var onloadCallback = function() {
    recaptchaID = grecaptcha.render('recaptcha', {
      'sitekey' : '6LfA2cAUAAAAABJoYq-MsGHj33RWhsXzEsn8bU72',
      'theme' : 'light',
      'size' : 'normal'
    });
  };
  </script>
</head>

<!-- 2 Top Bar -->
<body>
<div class = 'newUserContainer'>
  <div class = 'newUserBackToLogin'>
    <form action = 'login.php'>
      <input type = 'submit' value = 'Back To Log In'
        class = 'newUserBackToLoginButton' name = 'submit' />
    </form>
  </div>
  <div class = 'newUserCenter'>
    <div class = 'newUserTopBar'>
      <div class = 'newUserCorvin'>
        Corvin
      </div>
    </div>

    <br /><br /><br /><br /><br /><br />

    <!-- 3 Create new user form -->
    <!-- action = 'registerNewUser.php'
    method = 'post'
    enctype = 'multipart/form-data' -->
    <div class = 'newUserLogin'>
      <form
        id = 'registerNewUserForm'
      >
        <label>
          <input
            type = 'text'
            class = 'newUserTextBox'
            name = 'firstName'
            id = 'firstName'
            style = 'width: 300px'
            placeholder = 'First Name'
            autofocus
            required
            spellcheck = 'false'
            autocomplete = 'given-name'
          />
        </label>
        <br /><br />
        <label>
          <input
            type = 'text'
            class = 'newUserTextBox'
            name = 'lastName'
            id = 'lastName'
            style = 'width: 300px'
            placeholder = 'Last Name'
            required
            spellcheck = 'false'
            autocomplete = 'family-name'
          />
        </label>
        <br /><br />
        <label>
          <input
            type = 'email'
            class = 'newUserTextBox'
            name = 'email'
            id = 'email'
            style = 'width: 300px'
            placeholder = 'Email'
            required
            spellcheck = 'false'
            autocomplete = 'email'
          />
        </label>
        <br /><br />
        <label>
          <input
            type = 'text'
            class = 'newUserTextBox'
            name = 'username'
            id = 'username'
            style = 'width: 300px'
            placeholder = 'User Name'
            required
            spellcheck = 'false'
            autocomplete = 'username'
          />
        </label>
        <br /><br />
        <label>
          <input
            type = 'password'
            class = 'newUserTextBox'
            name = 'password'
            id = 'password'
            style = 'width: 300px'
            placeholder = 'Password (at least 8 characters)'
            autocomplete = 'new-password'
            required
          />
        </label>
        <br /><br />
        <label>
          <input
            type = 'password'
            class = 'newUserTextBox'
            name = 'password2'
            id = 'password2'
            style = 'width: 300px'
            placeholder = 'Re-enter Password'
            autocomplete = 'new-password'
            required
          />
        </label>
        <br /><br /><br />
        Account Tier
        <br /><br />
        <label>
          <input
            type = 'radio'
            name = 'accountTier'
            value = 'Free'
            checked
          />Free (250 MB)
          <br /><br />
          <input
            type = 'radio'
            name = 'accountTier'
            value = 'Plus'
          />Plus (100GB)
          <br /><br />
          <input
            type = 'radio'
            name = 'accountTier'
            value = 'Pro'
          />Pro (500GB)
          <br /><br />
          <input
            type = 'radio'
            name = 'accountTier'
            value = 'Referral'
          />I have a Referral Code
          <br />
        </label>
        <br />
        <label>
          <input
            type = 'text'
            class = 'newUserTextBox'
            name = 'referralCode'
            id = 'referralCode'
            style = 'width: 300px'
            placeholder = 'Referral Code'
            spellcheck = "false"
            autocomplete = "off"
          />
        </label>
        <br /><br />
        <button id = 'registerButton' class = "newUserLoginButton">
          Register
        </button>
      </form>
      <div class = "newUserPleaseCheckTheBox">
        <p class = "newUserMessageText" id = "message"></p>
      </div>
      <div id = "recaptcha" class = "newUserRecaptcha"></div>
      <script src = "https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit"
        async defer>
      </script>
      <script type = "text/javascript">
      $('#registerNewUserForm').submit(function (event) {

        event.preventDefault();

        var recaptcha = grecaptcha.getResponse(recaptchaID);

        if (recaptcha === "") {

          $('#message').show().text("Please check the box");
        }
        else {

          $('#message').hide(1);

          var firstName = $('#firstName').val();
          var lastName = $('#lastName').val();
          var email = $('#email').val();
          var username = $('#username').val();
          var password = $('#password').val();
          var password2 = $('#password2').val();
          var accountTier = $("input[name='accountTier']:checked").val();
          var referralCode = $('#referralCode').val();

          $.ajax({
            error:function(jqXHR,textStatus,errorThrown ){
              alert('Exception:'+errorThrown );
            },
            type: 'POST',
            dataType: 'JSON',
            url: 'registerNewUser.php',
            data: {
              recaptcha: recaptcha,
              firstName: firstName,
              lastName: lastName,
              email: email,
              username: username,
              password: password,
              password2: password2,
              accountTier: accountTier,
              referralCode: referralCode
            },
            success: function(data) {

              var data = eval(data);

              if (data.registerUser != 'true') {

                $('#message').show().text(data.registerUser);
                grecaptcha.reset();
              }
              else {

                $('#corvin').css('color', 'rgb(0, 130, 140)');

                var welcomeData = {
                  firstName: firstName,
                  accountTier: accountTier,
                  referralCode: referralCode
                }
                var form = document.createElement('form');
                document.body.appendChild(form);
                form.method = 'post';
                form.action = 'welcome.php';
                for (var name in welcomeData) {
                  var input = document.createElement('input');
                  input.type = 'hidden';
                  input.name = name;
                  input.value = welcomeData[name];
                  form.appendChild(input);
                }
                form.submit();
              }
            }
          });
        }
      });
      </script>
    </div>
  </div>
  <div class = 'newUserPush'></div>
</div>

<!-- 4 Footer -->
<div class = 'newUserFooter'>&copy; Corvin, Inc.</div>

</body>
</html>
